<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frutas RNG</title>
    <style>
        /* IN√çCIO DO CSS */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #1a1a2e;
            color: #e4e4e4;
            margin: 0;
            position: relative;
            overflow: hidden;
        }

        .event-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            animation: none;
        }

        .event-overlay.adm-event {
            background: radial-gradient(circle, rgba(255,0,255,0.2) 0%, rgba(255,0,255,0) 70%);
            opacity: 1;
            animation: pulse-purple 2s infinite alternate;
        }

        @keyframes pulse-purple {
            from { box-shadow: 0 0 20px 5px rgba(255,0,255,0.5); }
            to { box-shadow: 0 0 40px 15px rgba(255,0,255,0.7); }
        }

        .container {
            text-align: center;
            background: #2a2a4a;
            padding: 2.5rem;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            border: 2px solid #5a5a7a;
            width: 90%;
            max-width: 600px;
            position: relative;
            z-index: 10;
        }

        h1 {
            color: #e0acff;
            margin-bottom: 1.5rem;
        }
        
        #login-panel {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }
        
        .login-input {
            width: 80%;
            padding: 10px;
            font-size: 1rem;
            border: 2px solid #5a5a7a;
            border-radius: 8px;
            background-color: #1e1e3e;
            color: white;
        }

        .display {
            font-size: 1.8rem;
            margin-bottom: 1rem;
            background: #3a3a6a;
            padding: 10px;
            border-radius: 8px;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.3);
        }

        .slots-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .slot-display {
            text-align: center;
        }

        .slot {
            width: 90px;
            height: 90px;
            border: 3px solid #e0acff;
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3.5rem;
            background-color: #1e1e3e;
            box-shadow: 0 0 10px rgba(224, 172, 255, 0.5);
            transition: transform 0.1s ease-out;
            margin-bottom: 10px;
        }
        
        .slot-info {
            font-size: 1rem;
            font-weight: bold;
            height: 40px;
        }
        
        #session-timer {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 0.9rem;
            color: #ccc;
        }

        #logout-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 2rem;
            color: #dc3545;
            background: none;
            border: none;
            cursor: pointer;
            z-index: 20;
            line-height: 1;
        }

        #logout-btn:hover {
            color: #ff6347;
        }

        .event-info {
            font-size: 1rem;
            color: #e0acff;
            margin-bottom: 1rem;
            min-height: 20px;
        }
        
        .event-info.countdown {
            color: #28a745;
        }

        /* Cores de Raridade */
        .rarity-Comum { border-color: #6c757d; color: #6c757d; }
        .rarity-Incomum { border-color: #28a745; color: #28a745; }
        .rarity-Rara { border-color: #007bff; color: #007bff; }
        .rarity-Epica { border-color: #6f42c1; color: #6f42c1; }
        .rarity-Lendaria { border-color: #ffc107; color: #ffc107; }
        .rarity-Mistica { border-color: #dc3545; color: #dc3545; }
        .rarity-God { border-color: #ff7f50; color: #ff7f50; }
        .rarity-Demon { border-color: #8b0000; color: #8b0000; }
        .rarity-Secret { border-color: #00ffff; color: #00ffff; }
        .rarity-Divine { border-color: #ff00ff; color: #ff00ff; }
        .rarity-ADM { border-color: #ff00ff; color: #ff00ff; }

        button {
            padding: 0.75rem 1.8rem;
            font-size: 1.1rem;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            background-color: #e0acff;
            color: #1a1a2e;
            font-weight: bold;
            margin: 0 0.5rem;
            transition: background-color 0.2s, transform 0.1s;
        }
        
        .menu-buttons {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        
        button.rebirth-btn {
            background-color: #f07447;
            color: #1a1a2e;
        }
        
        button.admin-btn {
            background-color: #ffc107;
            color: #1a1a2e;
        }

        button.petshop-btn {
            background-color: #4CAF50;
            color: white;
        }

        button:hover:not(:disabled) {
            background-color: #ff99ff;
            transform: translateY(-2px);
        }
        
        button.admin-btn:hover:not(:disabled) {
            background-color: #ffd766;
        }

        button.rebirth-btn:hover:not(:disabled) {
            background-color: #ffa583;
        }

        button.petshop-btn:hover:not(:disabled) {
            background-color: #66BB6A;
        }

        button:disabled {
            background-color: #5a5a7a;
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .cost-info {
            font-size: 0.9rem;
            color: #bbb;
            margin-top: 5px;
        }
        
        .notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #dc3545;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            font-size: 1.1rem;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            z-index: 11;
        }

        .notification.show {
            opacity: 1;
        }

        /* Estilos do Modal de Eventos do ADM */
        #adm-message-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 10px;
            color: white;
            font-size: 1.2rem;
            z-index: 12;
            text-align: center;
            box-shadow: 0 0 20px 5px rgba(255, 0, 255, 0.5);
            display: none;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 10;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #2a2a4a;
            color: #e4e4e4;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(224, 172, 255, 0.4);
            width: 90%;
            max-width: 700px;
            position: relative;
            max-height: 80vh;
            overflow-y: auto;
            border: 2px solid #e0acff;
        }
        
        .catalog-section {
            margin-bottom: 2rem;
        }
        
        .catalog-section h3 {
            border-bottom: 2px solid;
            padding-bottom: 5px;
            margin-bottom: 1rem;
        }

        .item-grid {
            margin-top: 1.5rem;
            display: grid;
            gap: 1.2rem;
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
        }

        .item {
            text-align: center;
            padding: 10px;
            border-radius: 8px;
            background-color: #3a3a6a;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            border: 1px solid #5a5a7a;
            transition: transform 0.2s;
            cursor: pointer;
        }
        
        .item.inventory-item:hover {
            transform: scale(1.03);
            background-color: #4a4a7a;
        }

        .item.unobtained {
            opacity: 0.5;
            filter: grayscale(100%);
        }

        .item.equiped {
            border: 3px solid #ffc107;
            box-shadow: 0 0 10px 2px #ffc107;
        }

        .item span {
            font-size: 2rem;
            display: block;
            margin-bottom: 5px;
        }

        .item p {
            margin: 0 0 3px 0;
            font-weight: bold;
        }

        .item small {
            display: block;
            color: #ccc;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 2.5rem;
            font-weight: bold;
            color: #e0acff;
            background: none;
            border: none;
            cursor: pointer;
            line-height: 1;
        }

        .close-btn:hover {
            color: #ff99ff;
        }
        
        /* Estilos do Painel de Rebirth */
        .rebirth-info {
            text-align: left;
        }

        .rebirth-stage {
            border: 2px solid #5a5a7a;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .rebirth-stage.unlocked {
            border-color: #28a745;
        }
        
        .rebirth-stage h4 {
            margin-top: 0;
            color: #ffc107;
        }

        .rebirth-stage p {
            margin: 5px 0;
        }
        
        .rebirth-stage button {
            margin-top: 10px;
            width: 100%;
            padding: 10px;
            background-color: #28a745;
            color: white;
        }

        .rebirth-stage button:disabled {
            background-color: #6c757d;
        }
        
        #inventory-total-income {
            text-align: center;
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: #28a745;
            background-color: #1e1e3e;
            padding: 10px;
            border-radius: 8px;
        }
        
        #admin-panel .item-grid {
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        }

        #admin-panel .item {
            cursor: pointer;
        }
        
        #admin-panel .item:hover {
            transform: scale(1.03);
            background-color: #4a4a7a;
        }

        #admin-event-control {
            margin-top: 2rem;
        }
        #admin-event-control h4 {
            color: #ffc107;
        }
        #admin-event-control .event-buttons button {
            margin: 5px;
        }

        #merchant-timer {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background-color: #4a4a7a;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 0.9rem;
            z-index: 10;
        }

        #merchant-modal .item {
            padding: 15px;
        }
        
        #merchant-modal .item button {
            margin-top: 10px;
            padding: 5px 10px;
            font-size: 0.9rem;
            background-color: #28a745;
        }

        /* FIM DO CSS */
    </style>
</head>
<body>
    <div class="event-overlay" id="event-overlay"></div>
    <div class="container">
        <h1>Frutas RNG üé∞</h1>

        <div id="login-panel">
            <h2>Bem-vindo!</h2>
            <input type="text" id="username-input" placeholder="Nome de Usu√°rio" class="login-input">
            <input type="password" id="password-input" placeholder="Senha" class="login-input">
            <button id="login-btn">Entrar/Criar Conta</button>
        </div>

        <div id="game-panel" style="display: none;">
            <div id="session-timer" style="display:none;"></div>
            <button id="logout-btn" style="display:none;">&times;</button>
            <div class="display">
                Dinheiro: $<span id="money">0.00</span> üí∏
            </div>
            <p>Rebirths: <span id="rebirth-count">0</span> üîÑ | Capacidade: <span id="inventory-capacity-display">10</span> üì¶</p>

            <div class="slots-container">
                <div class="slot-display">
                    <div class="slot" id="slot1">?</div>
                    <div class="slot-info">
                        <p id="fruit-name"></p>
                        <p id="fruit-rarity"></p>
                    </div>
                </div>
            </div>

            <div class="event-info" id="event-timer-display"></div>

            <button id="spin-btn">Girar Fruta</button>
            <span class="cost-info" id="spin-cost">1¬∫ Giro Gr√°tis!</span>
            <div class="menu-buttons">
                <button id="inventory-btn">Invent√°rio üéí</button>
                <button id="catalog-btn">Cat√°logo üìñ</button>
                <button id="rebirth-btn" class="rebirth-btn">Rebirth üîÑ</button>
                <button id="petshop-btn" class="petshop-btn">Pet Shop üê∂</button>
                <button id="admin-btn" class="admin-btn" style="display: none;">Admin Panel üõ†Ô∏è</button>
            </div>
        </div>

        <div id="inventory" class="modal">
            <div class="modal-content">
                <h2>Seu Invent√°rio üéí</h2>
                <div id="inventory-total-income">Renda Passiva Total: $0.00/s</div>
                <div id="inventory-list" class="item-grid"></div>
                <button class="close-btn">&times;</button>
            </div>
        </div>
        
        <div id="catalog" class="modal">
            <div class="modal-content">
                <h2>Cat√°logo de Frutas üìñ</h2>
                <div id="catalog-list"></div>
                <button class="close-btn">&times;</button>
            </div>
        </div>
        
        <div id="rebirth-modal" class="modal">
            <div class="modal-content">
                <h2>Rebirth üîÑ</h2>
                <div id="rebirth-list" class="rebirth-info"></div>
                <button class="close-btn">&times;</button>
            </div>
        </div>
        
        <div id="admin-panel" class="modal">
            <div class="modal-content">
                <h2>Admin Panel üõ†Ô∏è</h2>
                <div id="admin-event-control">
                    <h4>Ativar Evento</h4>
                    <div class="event-buttons">
                        <button id="adm-event-money">Dinheiro</button>
                        <button id="adm-event-discount">Desconto</button>
                        <button id="adm-event-adm">Evento ADM</button>
                    </div>
                </div>
                <div id="admin-fruit-spawn">
                    <h4>Spawnar Fruta</h4>
                    <p>Clique em uma fruta para adicion√°-la ao seu invent√°rio.</p>
                    <div id="admin-fruit-list" class="item-grid"></div>
                </div>
                <button class="close-btn">&times;</button>
            </div>
        </div>
        
        <div id="petshop-modal" class="modal">
            <div class="modal-content">
                <h2>Pet Shop üê∂</h2>
                <div id="petshop-list" class="item-grid"></div>
                <button class="close-btn">&times;</button>
            </div>
        </div>

        <div id="merchant-modal" class="modal">
            <div class="modal-content">
                <h2>Comerciante de Frutas ü§ù</h2>
                <p>Aqui est√£o as frutas que tenho para vender:</p>
                <div id="merchant-list" class="item-grid"></div>
                <button class="close-btn">&times;</button>
            </div>
        </div>

        <div id="adm-message-container">
            <span id="adm-message"></span>
        </div>
        
        <div id="notification-message" class="notification"></div>
        <div id="merchant-timer">Comerciante em: 60s</div>
    </div>

    <script>
        /* IN√çCIO DO JAVASCRIPT */
        const loginPanel = document.getElementById('login-panel');
        const gamePanel = document.getElementById('game-panel');
        const usernameInput = document.getElementById('username-input');
        const passwordInput = document.getElementById('password-input');
        const loginBtn = document.getElementById('login-btn');
        const logoutBtn = document.getElementById('logout-btn');
        const moneyDisplay = document.getElementById('money');
        const slot = document.getElementById('slot1');
        const fruitNameDisplay = document.getElementById('fruit-name');
        const fruitRarityDisplay = document.getElementById('fruit-rarity');
        const spinBtn = document.getElementById('spin-btn');
        const spinCostDisplay = document.getElementById('spin-cost');
        const inventoryBtn = document.getElementById('inventory-btn');
        const catalogBtn = document.getElementById('catalog-btn');
        const rebirthBtn = document.getElementById('rebirth-btn');
        const adminBtn = document.getElementById('admin-btn');
        const petshopBtn = document.getElementById('petshop-btn');
        const inventoryModal = document.getElementById('inventory');
        const catalogModal = document.getElementById('catalog');
        const rebirthModal = document.getElementById('rebirth-modal');
        const adminPanel = document.getElementById('admin-panel');
        const petshopModal = document.getElementById('petshop-modal');
        const merchantModal = document.getElementById('merchant-modal');
        const inventoryCapacityDisplay = document.getElementById('inventory-capacity-display');
        const rebirthCountDisplay = document.getElementById('rebirth-count');
        const inventoryList = document.getElementById('inventory-list');
        const inventoryTotalIncomeDisplay = document.getElementById('inventory-total-income');
        const catalogList = document.getElementById('catalog-list');
        const rebirthList = document.getElementById('rebirth-list');
        const adminFruitList = document.getElementById('admin-fruit-list');
        const petshopList = document.getElementById('petshop-list');
        const merchantList = document.getElementById('merchant-list');
        const closeBtns = document.querySelectorAll('.close-btn');
        const notificationMessage = document.getElementById('notification-message');
        const eventOverlay = document.getElementById('event-overlay');
        const admMessageContainer = document.getElementById('adm-message-container');
        const admMessageDisplay = document.getElementById('adm-message');
        const eventTimerDisplay = document.getElementById('event-timer-display');
        const merchantTimerDisplay = document.getElementById('merchant-timer');
        const admEventMoneyBtn = document.getElementById('adm-event-money');
        const admEventDiscountBtn = document.getElementById('adm-event-discount');
        const admEventAdmBtn = document.getElementById('adm-event-adm');
        const sessionTimerDisplay = document.getElementById('session-timer');

        let money = 0;
        let inventory = {};
        let firstSpin = true;
        let rebirthCount = 0;
        let inventoryCapacity = 10;
        let obtainedFruits = [];
        let obtainedPets = [];
        let equippedPet = null;
        let loggedInUser = null;
        let spinCount = 0;
        const SPINS_FOR_DISCOUNT = 20;
        const BASE_SPIN_COST = 150;
        let currentSpinCost = BASE_SPIN_COST;
        let activeEvent = null;
        let eventInterval;
        let eventCountdown = 0;
        let merchantInterval;
        let merchantCountdown = 60;
        let admMessageInterval;
        let sessionTimerInterval;
        let sessionStartTime = 0;
        let sessionElapsedTime = 0;

        const ADMIN_USER = "ADM123";
        const ADMIN_PASS = "ADM123";

        const fruits = [
            // Frutas Comuns (65) - Chance: 70%
            { name: "Ma√ß√£", rarity: "Comum", emoji: "üçé", value: 50, chance: 1.07 },
            { name: "Laranja", rarity: "Comum", emoji: "üçä", value: 60, chance: 1.07 },
            { name: "Banana", rarity: "Comum", emoji: "üçå", value: 75, chance: 1.07 },
            { name: "Uva Verde", rarity: "Comum", emoji: "üçá", value: 65, chance: 1.07 },
            { name: "Pera", rarity: "Comum", emoji: "üçê", value: 55, chance: 1.07 },
            { name: "P√™ssego", rarity: "Comum", emoji: "üçë", value: 70, chance: 1.07 },
            { name: "Cereja", rarity: "Comum", emoji: "üçí", value: 80, chance: 1.07 },
            { name: "Lim√£o", rarity: "Comum", emoji: "üçã", value: 85, chance: 1.07 },
            { name: "Mel√£o", rarity: "Comum", emoji: "üçà", value: 90, chance: 1.07 },
            { name: "Coco", rarity: "Comum", emoji: "ü••", value: 95, chance: 1.07 },
            { name: "Abacate", rarity: "Comum", emoji: "ü•ë", value: 100, chance: 1.07 },
            { name: "Tomate", rarity: "Comum", emoji: "üçÖ", value: 105, chance: 1.07 },
            { name: "Kiwi", rarity: "Comum", emoji: "ü•ù", value: 110, chance: 1.07 },
            { name: "Abacaxi", rarity: "Comum", emoji: "üçç", value: 115, chance: 1.07 },
            { name: "Manga", rarity: "Comum", emoji: "ü•≠", value: 120, chance: 1.07 },
            { name: "Framboesa", rarity: "Comum", emoji: "üçá", value: 125, chance: 1.07 },
            { name: "Rom√£", rarity: "Comum", emoji: "üçé", value: 130, chance: 1.07 },
            { name: "Morango", rarity: "Comum", emoji: "üçì", value: 135, chance: 1.07 },
            { name: "Amora", rarity: "Comum", emoji: "ü´ê", value: 140, chance: 1.07 },
            { name: "Mirtilo", rarity: "Comum", emoji: "ü´ê", value: 145, chance: 1.07 },
            { name: "Caju", rarity: "Comum", emoji: "ü•ú", value: 150, chance: 1.07 },
            { name: "Cacau", rarity: "Comum", emoji: "üç´", value: 155, chance: 1.07 },
            { name: "Ameixa", rarity: "Comum", emoji: "üçë", value: 160, chance: 1.07 },
            { name: "Damasco", rarity: "Comum", emoji: "üß°", value: 165, chance: 1.07 },
            { name: "Figo", rarity: "Comum", emoji: "ü´ê", value: 170, chance: 1.07 },
            { name: "Goiaba", rarity: "Comum", emoji: "üçà", value: 175, chance: 1.07 },
            { name: "Lim√£o Siciliano", rarity: "Comum", emoji: "üçã", value: 180, chance: 1.07 },
            { name: "Lichia", rarity: "Comum", emoji: "üî¥", value: 185, chance: 1.07 },
            { name: "Tamarindo", rarity: "Comum", emoji: "üå∞", value: 190, chance: 1.07 },
            { name: "Cenoura", rarity: "Comum", emoji: "ü•ï", value: 195, chance: 1.07 },
            { name: "Milho", rarity: "Comum", emoji: "üåΩ", value: 200, chance: 1.07 },
            { name: "Brocolis", rarity: "Comum", emoji: "ü•¶", value: 205, chance: 1.07 },
            { name: "Berinjela", rarity: "Comum", emoji: "üçÜ", value: 210, chance: 1.07 },
            { name: "Batata", rarity: "Comum", emoji: "ü•î", value: 215, chance: 1.07 },
            { name: "Piment√£o", rarity: "Comum", emoji: "ü´ë", value: 220, chance: 1.07 },
            { name: "Cebola", rarity: "Comum", emoji: "üßÖ", value: 225, chance: 1.07 },
            { name: "Alho", rarity: "Comum", emoji: "üßÑ", value: 230, chance: 1.07 },
            { name: "Pimenta", rarity: "Comum", emoji: "üå∂Ô∏è", value: 235, chance: 1.07 },
            { name: "Pepino", rarity: "Comum", emoji: "ü•í", value: 240, chance: 1.07 },
            { name: "Alface", rarity: "Comum", emoji: "ü•¨", value: 245, chance: 1.07 },
            { name: "Espinafre", rarity: "Comum", emoji: "üçÉ", value: 250, chance: 1.07 },
            { name: "Couve-flor", rarity: "Comum", emoji: "ü•¶", value: 255, chance: 1.07 },
            { name: "Cogumelo", rarity: "Comum", emoji: "üçÑ", value: 260, chance: 1.07 },
            { name: "Beterraba", rarity: "Comum", emoji: "üî¥", value: 265, chance: 1.07 },
            { name: "Rabanete", rarity: "Comum", emoji: "‚ö™", value: 270, chance: 1.07 },
            { name: "Vagem", rarity: "Comum", emoji: "üü¢", value: 275, chance: 1.07 },
            { name: "Ab√≥bora", rarity: "Comum", emoji: "üéÉ", value: 280, chance: 1.07 },
            { name: "Nabo", rarity: "Comum", emoji: "‚ö™", value: 285, chance: 1.07 },
            { name: "Alcachofra", rarity: "Comum", emoji: "üíö", value: 290, chance: 1.07 },
            { name: "Aspargo", rarity: "Comum", emoji: "üü¢", value: 295, chance: 1.07 },
            { name: "Acelga", rarity: "Comum", emoji: "ü•¨", value: 300, chance: 1.07 },
            { name: "Erva Doce", rarity: "Comum", emoji: "üåø", value: 305, chance: 1.07 },
            { name: "R√∫cula", rarity: "Comum", emoji: "üçÉ", value: 310, chance: 1.07 },
            { name: "Bambu", rarity: "Comum", emoji: "üéç", value: 315, chance: 1.07 },
            { name: "Trigo", rarity: "Comum", emoji: "üåæ", value: 320, chance: 1.07 },
            { name: "Arroz", rarity: "Comum", emoji: "üçö", value: 325, chance: 1.07 },
            { name: "Soja", rarity: "Comum", emoji: "üå±", value: 330, chance: 1.07 },
            { name: "Feij√£o", rarity: "Comum", emoji: "ü´ò", value: 335, chance: 1.07 },
            { name: "Lentilha", rarity: "Comum", emoji: "ü´ò", value: 340, chance: 1.07 },
            { name: "Gr√£o de Bico", rarity: "Comum", emoji: "ü´ò", value: 345, chance: 1.07 },
            { name: "Milhete", rarity: "Comum", emoji: "üåæ", value: 350, chance: 1.07 },
            { name: "Aveia", rarity: "Comum", emoji: "üåæ", value: 355, chance: 1.07 },
            { name: "Malagueta", rarity: "Comum", emoji: "üå∂Ô∏è", value: 360, chance: 1.07 },
            { name: "Gengibre", rarity: "Comum", emoji: "ü´ö", value: 365, chance: 1.07 },
            { name: "Alho Por√≥", rarity: "Comum", emoji: "üßÖ", value: 370, chance: 1.07 },
            
            // Frutas Incomuns (45) - Chance: 20%
            { name: "A√ßa√≠", rarity: "Incomum", emoji: "üíú", value: 400, chance: 0.44 },
            { name: "Carambola", rarity: "Incomum", emoji: "‚≠ê", value: 425, chance: 0.44 },
            { name: "Pitaya Rosa", rarity: "Incomum", emoji: "üíñ", value: 450, chance: 0.44 },
            { name: "Maracuj√°", rarity: "Incomum", emoji: "üü°", value: 475, chance: 0.44 },
            { name: "Caj√°", rarity: "Incomum", emoji: "üü†", value: 500, chance: 0.44 },
            { name: "Sapoti", rarity: "Incomum", emoji: "üü§", value: 525, chance: 0.44 },
            { name: "Physalis", rarity: "Incomum", emoji: "üçä", value: 550, chance: 0.44 },
            { name: "Jabuticaba", rarity: "Incomum", emoji: "‚ö´", value: 575, chance: 0.44 },
            { name: "Jambo", rarity: "Incomum", emoji: "ü©∑", value: 600, chance: 0.44 },
            { name: "Caj√°-Manga", rarity: "Incomum", emoji: "üü°", value: 625, chance: 0.44 },
            { name: "Jenipapo", rarity: "Incomum", emoji: "‚ö´", value: 650, chance: 0.44 },
            { name: "Acerola", rarity: "Incomum", emoji: "üçí", value: 675, chance: 0.44 },
            { name: "Mam√£o", rarity: "Incomum", emoji: "ü•≠", value: 700, chance: 0.44 },
            { name: "Nectarina", rarity: "Incomum", emoji: "üçë", value: 725, chance: 0.44 },
            { name: "Tangerina", rarity: "Incomum", emoji: "üçä", value: 750, chance: 0.44 },
            { name: "Seriguela", rarity: "Incomum", emoji: "üî¥", value: 775, chance: 0.44 },
            { name: "Ing√°", rarity: "Incomum", emoji: "‚ö™", value: 800, chance: 0.44 },
            { name: "Cagaita", rarity: "Incomum", emoji: "üü°", value: 825, chance: 0.44 },
            { name: "Umbu", rarity: "Incomum", emoji: "üü¢", value: 850, chance: 0.44 },
            { name: "Cabeludinha", rarity: "Incomum", emoji: "üü†", value: 875, chance: 0.44 },
            { name: "Cambuci", rarity: "Incomum", emoji: "üü¢", value: 900, chance: 0.44 },
            { name: "Murici", rarity: "Incomum", emoji: "üü°", value: 925, chance: 0.44 },
            { name: "Ara√ß√°", rarity: "Incomum", emoji: "üíõ", value: 950, chance: 0.44 },
            { name: "Pequi", rarity: "Incomum", emoji: "üß°", value: 975, chance: 0.44 },
            { name: "Feijoa", rarity: "Incomum", emoji: "ü•ù", value: 1000, chance: 0.44 },
            { name: "Loquat", rarity: "Incomum", emoji: "üü†", value: 1025, chance: 0.44 },
            { name: "Salak", rarity: "Incomum", emoji: "üêç", value: 1050, chance: 0.44 },
            { name: "Rambutan", rarity: "Incomum", emoji: "üî¥", value: 1075, chance: 0.44 },
            { name: "Longan", rarity: "Incomum", emoji: "‚ö™", value: 1100, chance: 0.44 },
            { name: "Mangostim", rarity: "Incomum", emoji: "üíú", value: 1125, chance: 0.44 },
            { name: "Pitomba", rarity: "Incomum", emoji: "üü°", value: 1150, chance: 0.44 },
            { name: "Pinha", rarity: "Incomum", emoji: "üü¢", value: 1175, chance: 0.44 },
            { name: "Sapucaia", rarity: "Incomum", emoji: "üü§", value: 1200, chance: 0.44 },
            { name: "Buriti", rarity: "Incomum", emoji: "üü†", value: 1225, chance: 0.44 },
            { name: "Carna√∫ba", rarity: "Incomum", emoji: "üå¥", value: 1250, chance: 0.44 },
            { name: "Coco da Bahia", rarity: "Incomum", emoji: "ü••", value: 1275, chance: 0.44 },
            { name: "Groselha", rarity: "Incomum", emoji: "üçá", value: 1300, chance: 0.44 },
            { name: "Cupuassu", rarity: "Incomum", emoji: "üü§", value: 1325, chance: 0.44 },
            { name: "Jambo Roxo", rarity: "Incomum", emoji: "üíú", value: 1350, chance: 0.44 },
            { name: "Abacaxi P√©rola", rarity: "Incomum", emoji: "üçç", value: 1375, chance: 0.44 },
            { name: "Manga Palmer", rarity: "Incomum", emoji: "ü•≠", value: 1400, chance: 0.44 },
            { name: "Ma√ß√£ Gala", rarity: "Incomum", emoji: "üçé", value: 1425, chance: 0.44 },
            { name: "Banana Prata", rarity: "Incomum", emoji: "üçå", value: 1450, chance: 0.44 },
            { name: "Maracuj√° Doce", rarity: "Incomum", emoji: "üü°", value: 1475, chance: 0.44 },
            { name: "Melancia Mini", rarity: "Incomum", emoji: "üçâ", value: 1500, chance: 0.44 },
            
            // Frutas Raras (30) - Chance: 8.5%
            { name: "Fruta-do-Conde", rarity: "Rara", emoji: "üçê", value: 2000, chance: 0.283 },
            { name: "Bacuri", rarity: "Rara", emoji: "üü°", value: 2150, chance: 0.283 },
            { name: "Guaran√°", rarity: "Rara", emoji: "üëÄ", value: 2300, chance: 0.283 },
            { name: "Birib√°", rarity: "Rara", emoji: "üü¢", value: 2450, chance: 0.283 },
            { name: "Araticum", rarity: "Rara", emoji: "üü§", value: 2600, chance: 0.283 },
            { name: "Mangaba", rarity: "Rara", emoji: "üçä", value: 2750, chance: 0.283 },
            { name: "Graviola", rarity: "Rara", emoji: "üçà", value: 2900, chance: 0.283 },
            { name: "Jaca", rarity: "Rara", emoji: "üçà", value: 3050, chance: 0.283 },
            { name: "Ambrosia", rarity: "Rara", emoji: "üçØ", value: 3200, chance: 0.283 },
            { name: "Atemoia", rarity: "Rara", emoji: "üçè", value: 3350, chance: 0.283 },
            { name: "Jamel√£o", rarity: "Rara", emoji: "üçá", value: 3500, chance: 0.283 },
            { name: "Pinda√≠ba", rarity: "Rara", emoji: "üçç", value: 3650, chance: 0.283 },
            { name: "Cagaita", rarity: "Rara", emoji: "üü°", value: 3800, chance: 0.283 },
            { name: "Ju√ßara", rarity: "Rara", emoji: "üíú", value: 3950, chance: 0.283 },
            { name: "Abiu", rarity: "Rara", emoji: "üçã", value: 4100, chance: 0.283 },
            { name: "Caj√°-Mirim", rarity: "Rara", emoji: "üß°", value: 4250, chance: 0.283 },
            { name: "Pau-Ferro", rarity: "Rara", emoji: "ü™µ", value: 4400, chance: 0.283 },
            { name: "Mutamba", rarity: "Rara", emoji: "ü•ú", value: 4550, chance: 0.283 },
            { name: "Pitangatuba", rarity: "Rara", emoji: "üî¥", value: 4700, chance: 0.283 },
            { name: "Pitaya Roxa", rarity: "Rara", emoji: "üíú", value: 4850, chance: 0.283 },
            { name: "Mel√£o de S√£o Caetano", rarity: "Rara", emoji: "üçà", value: 5000, chance: 0.283 },
            { name: "Inhame", rarity: "Rara", emoji: "üç†", value: 5150, chance: 0.283 },
            { name: "Mandioca", rarity: "Rara", emoji: "üç†", value: 5300, chance: 0.283 },
            { name: "Milho Roxo", rarity: "Rara", emoji: "üåΩ", value: 5450, chance: 0.283 },
            { name: "Batata Doce", rarity: "Rara", emoji: "üç†", value: 5600, chance: 0.283 },
            { name: "Taro", rarity: "Rara", emoji: "ü•î", value: 5750, chance: 0.283 },
            { name: "Yacon", rarity: "Rara", emoji: "ü•î", value: 5900, chance: 0.283 },
            { name: "Gua√ßatonga", rarity: "Rara", emoji: "üçÉ", value: 6050, chance: 0.283 },
            { name: "Pinh√£o", rarity: "Rara", emoji: "üå∞", value: 6200, chance: 0.283 },
            { name: "Cupua√ßu Gigante", rarity: "Rara", emoji: "üü§", value: 6350, chance: 0.283 },

            // Frutas √âpicas (20) - Chance: 1.25%
            { name: "Fruta-p√£o", rarity: "Epica", emoji: "ü•ñ", value: 7500, chance: 0.0625 },
            { name: "Pitaia Amarela", rarity: "Epica", emoji: "üíõ", value: 8000, chance: 0.0625 },
            { name: "Noni", rarity: "Epica", emoji: "ü§¢", value: 8500, chance: 0.0625 },
            { name: "Rambut√£o Amarelo", rarity: "Epica", emoji: "üçã", value: 9000, chance: 0.0625 },
            { name: "Ma√ß√£ de Elefante", rarity: "Epica", emoji: "üêò", value: 9500, chance: 0.0625 },
            { name: "Fruta-do-Milagre", rarity: "Epica", emoji: "‚ú®", value: 10000, chance: 0.0625 },
            { name: "Fruta-do-Drag√£o", rarity: "Epica", emoji: "üêâ", value: 10500, chance: 0.0625 },
            { name: "Kiwi Dourado", rarity: "Epica", emoji: "üíõ", value: 11000, chance: 0.0625 },
            { name: "Mangaba Roxa", rarity: "Epica", emoji: "üçá", value: 11500, chance: 0.0625 },
            { name: "Abacaxi Negro", rarity: "Epica", emoji: "üçç", value: 12000, chance: 0.0625 },
            { name: "Jabuticaba Branca", rarity: "Epica", emoji: "‚ö™", value: 12500, chance: 0.0625 },
            { name: "Atemoia Gigante", rarity: "Epica", emoji: "üçè", value: 13000, chance: 0.0625 },
            { name: "Jaca Amarela", rarity: "Epica", emoji: "üü°", value: 13500, chance: 0.0625 },
            { name: "Seriguela Roxa", rarity: "Epica", emoji: "üíú", value: 14000, chance: 0.0625 },
            { name: "Marolo Negro", rarity: "Epica", emoji: "üåë", value: 14500, chance: 0.0625 },
            { name: "Sapota Preta", rarity: "Epica", emoji: "‚ö´", value: 15000, chance: 0.0625 },
            { name: "Atemoia Rosa", rarity: "Epica", emoji: "üíñ", value: 15500, chance: 0.0625 },
            { name: "Uva Gigante", rarity: "Epica", emoji: "üçá", value: 16000, chance: 0.0625 },
            { name: "Coco Dourado", rarity: "Epica", emoji: "ü••", value: 16500, chance: 0.0625 },
            { name: "Lichia Gigante", rarity: "Epica", emoji: "üî¥", value: 17000, chance: 0.0625 },

            // Frutas Lend√°rias (10) - Chance: 0.25%
            { name: "Fruta do Drag√£o Negro", rarity: "Lendaria", emoji: "üñ§", value: 30000, chance: 0.025 },
            { name: "Cereja de Ouro", rarity: "Lendaria", emoji: "ü•á", value: 35000, chance: 0.025 },
            { name: "Caju de Fogo", rarity: "Lendaria", emoji: "üî•", value: 40000, chance: 0.025 },
            { name: "Manga de Diamante", rarity: "Lendaria", emoji: "üíé", value: 45000, chance: 0.025 },
            { name: "P√™ssego da Imortalidade", rarity: "Lendaria", emoji: "‚ú®", value: 50000, chance: 0.025 },
            { name: "Ma√ß√£ de Ad√£o", rarity: "Lendaria", emoji: "üçé", value: 55000, chance: 0.025 },
            { name: "Uva C√≥smica", rarity: "Lendaria", emoji: "üåå", value: 60000, chance: 0.025 },
            { name: "Pera da Sabedoria", rarity: "Lendaria", emoji: "üß†", value: 65000, chance: 0.025 },
            { name: "Ameixa da Eternidade", rarity: "Lendaria", emoji: "‚ôæÔ∏è", value: 70000, chance: 0.025 },
            { name: "Mel√£o Celestial", rarity: "Lendaria", emoji: "üå†", value: 75000, chance: 0.025 },

            // Frutas M√≠sticas (5) - Chance: 0.05%
            { name: "Banana de Cristal", rarity: "Mistica", emoji: "üîÆ", value: 150000, chance: 0.01 },
            { name: "Lim√£o do Tempo", rarity: "Mistica", emoji: "‚è≥", value: 175000, chance: 0.01 },
            { name: "Fruta do Destino", rarity: "Mistica", emoji: "üîÆ", value: 200000, chance: 0.01 },
            { name: "Kiwi da Sorte", rarity: "Mistica", emoji: "üçÄ", value: 225000, chance: 0.01 },
            { name: "Cereja do Esquecimento", rarity: "Mistica", emoji: "ü´•", value: 250000, chance: 0.01 },

            // Frutas God (3) - Chance: 0.008%
            { name: "Amora da Cria√ß√£o", rarity: "God", emoji: "üåå", value: 500000, chance: 0.0026 },
            { name: "Uva da Destrui√ß√£o", rarity: "God", emoji: "üí•", value: 625000, chance: 0.0026 },
            { name: "P√™ssego da Vida", rarity: "God", emoji: "üå≥", value: 750000, chance: 0.0026 },

            // Frutas Demon (2) - Chance: 0.002%
            { name: "Fruta do Caos", rarity: "Demon", emoji: "üåÄ", value: 2500000, chance: 0.001 },
            { name: "Ma√ß√£ Proibida", rarity: "Demon", emoji: "üçéüö´", value: 3750000, chance: 0.001 },

            // Frutas Secretas (2) - Chance: 0.0005%
            { name: "Nucleo de Cereja", rarity: "Secret", emoji: "üçí‚ú®", value: 1500000, chance: 0.0005 },
            { name: "Semente Dourada", rarity: "Divine", emoji: "‚öúÔ∏è", value: 100000000, chance: 0.0005 },
        ];

        const rarities = ["Comum", "Incomum", "Rara", "Epica", "Lendaria", "Mistica", "God", "Demon", "Secret", "Divine"];
        
        const pets = [
            { name: "Coelho Sortudo", emoji: "üêá", cost: 10000, bonus: 500 },
            { name: "Gato Pescador", emoji: "üêà", cost: 50000, bonus: 2000 },
            { name: "Macaco M√°gico", emoji: "üêí", cost: 250000, bonus: 10000 },
            { name: "Drag√£o Dourado", emoji: "üêâ", cost: 1000000, bonus: 50000 },
            { name: "F√™nix Flamejante", emoji: "üî•üê¶", cost: 5000000, bonus: 250000 },
            { name: "C√£o da Fortuna", emoji: "üêï‚Äçü¶∫", cost: 10000000, bonus: 500000 }
        ];

        let currentFruitList = [...fruits];

        const fruitsByRarity = rarities.reduce((acc, rarity) => {
            acc[rarity] = fruits.filter(f => f.rarity === rarity);
            return acc;
        }, {});

        const rebirths = [
            { cost: 1500, fruit: "Graviola", emoji: "üçà" },
            { cost: 3000, fruit: "Jaca", emoji: "üçà" },
            { cost: 5000, fruit: "Fruta-p√£o", emoji: "ü•ñ" },
            { cost: 10000, fruit: "Noni", emoji: "ü§¢" },
            { cost: 20000, fruit: "Pitaia Amarela", emoji: "üíõ" },
            { cost: 50000, fruit: "Uva C√≥smica", emoji: "üåå" },
            { cost: 100000, fruit: "Banana de Cristal", emoji: "üîÆ" },
            { cost: 250000, fruit: "Amora da Cria√ß√£o", rarity: "God", emoji: "üåå" },
            { cost: 500000, fruit: "Ma√ß√£ Proibida", rarity: "Demon", emoji: "üçéüö´" },
            { cost: 1000000, fruit: "Nucleo de Cereja", rarity: "Secret", emoji: "üçí‚ú®" }
        ];
        
        const admMessages = [
            "O ADM est√° online! Prepare-se para a divers√£o. ü§ñ",
            "O que a panela disse para a frigideira? Eu te dou a maior cobertura! üòÇ",
            "Ei, viu meu emoji de rei? üëë Fui eu que fiz!",
            "O que o p√£o de forma foi fazer na academia? Malhar o corpo! üçû",
            "Perguntei para o tomate por que ele estava bravo. Ele respondeu: 'N√£o me pergunte, eu estou com raiva de tudo!' üò†",
            "Faltam s√≥ 30 segundos! A surpresa est√° quase no ponto! üéÅ",
            "O que a chave disse para o cadeado? 'Estamos prestes a nos trancar!' üóùÔ∏è",
            "A surpresa est√° chegando... s√≥ mais um pouquinho de paci√™ncia! üòâ"
        ];
        
        let passiveIncomeInterval;
        let admEventCheckInterval;
        let merchantCheckInterval;

        function formatMoney(amount) {
            if (amount >= 1000000000) {
                return (amount / 1000000000).toFixed(2) + 'B';
            }
            if (amount >= 1000000) {
                return (amount / 1000000).toFixed(2) + 'M';
            }
            if (amount >= 1000) {
                return (amount / 1000).toFixed(2) + 'K';
            }
            return amount.toFixed(2);
        }

        function showNotification(message, duration = 4000) {
            notificationMessage.textContent = message;
            notificationMessage.classList.add('show');
            setTimeout(() => {
                notificationMessage.classList.remove('show');
            }, duration);
        }

        function saveGame() {
            if (loggedInUser) {
                const userData = {
                    money,
                    inventory,
                    firstSpin,
                    rebirthCount,
                    inventoryCapacity,
                    obtainedFruits,
                    spinCount,
                    obtainedPets,
                    equippedPet,
                    sessionElapsedTime
                };
                localStorage.setItem(`userData_${loggedInUser}`, JSON.stringify(userData));
                localStorage.setItem(`userPassword_${loggedInUser}`, passwordInput.value);
            }
        }

        function loadGame(username) {
            const userData = JSON.parse(localStorage.getItem(`userData_${username}`));
            if (userData) {
                money = userData.money;
                inventory = userData.inventory;
                firstSpin = userData.firstSpin;
                rebirthCount = userData.rebirthCount;
                inventoryCapacity = userData.inventoryCapacity;
                obtainedFruits = userData.obtainedFruits || [];
                spinCount = userData.spinCount || 0;
                obtainedPets = userData.obtainedPets || [];
                equippedPet = userData.equippedPet || null;
                sessionElapsedTime = userData.sessionElapsedTime || 0;
            } else {
                money = 0;
                inventory = {};
                firstSpin = true;
                rebirthCount = 0;
                inventoryCapacity = 10;
                obtainedFruits = [];
                spinCount = 0;
                obtainedPets = [];
                equippedPet = null;
                sessionElapsedTime = 0;
            }
            updateUI();
        }

        function updateSessionTimer() {
            const now = Date.now();
            sessionElapsedTime += (now - sessionStartTime) / 1000;
            sessionStartTime = now;
            
            const hours = Math.floor(sessionElapsedTime / 3600);
            const minutes = Math.floor((sessionElapsedTime % 3600) / 60);
            const seconds = Math.floor(sessionElapsedTime % 60);
            
            sessionTimerDisplay.textContent = `Tempo Online: ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        function startSessionTimer() {
            sessionStartTime = Date.now();
            sessionTimerInterval = setInterval(updateSessionTimer, 1000);
            sessionTimerDisplay.style.display = 'block';
        }
        
        function stopSessionTimer() {
            clearInterval(sessionTimerInterval);
            sessionTimerDisplay.style.display = 'none';
        }

        function updateUI() {
            moneyDisplay.textContent = formatMoney(money);
            rebirthCountDisplay.textContent = rebirthCount;
            inventoryCapacityDisplay.textContent = inventoryCapacity;
            spinCostDisplay.textContent = firstSpin ? "1¬∫ Giro Gr√°tis!" : `Custo: $${formatMoney(currentSpinCost)}`;
            updateInventoryInfo();
            
            if (loggedInUser === ADMIN_USER) {
                adminBtn.style.display = 'inline-block';
            } else {
                adminBtn.style.display = 'none';
            }

            if (!activeEvent) {
                const spinsLeft = SPINS_FOR_DISCOUNT - (spinCount % SPINS_FOR_DISCOUNT);
                eventTimerDisplay.textContent = `Desconto em ${spinsLeft} giros!`;
            }
            
            merchantTimerDisplay.textContent = `Comerciante em: ${merchantCountdown}s`;
            logoutBtn.style.display = 'block';
        }
        
        function startGameSession(username) {
            loggedInUser = username;
            loginPanel.style.display = 'none';
            gamePanel.style.display = 'block';
            loadGame(username);
            
            if (passiveIncomeInterval) clearInterval(passiveIncomeInterval);
            passiveIncomeInterval = setInterval(() => {
                const passiveIncome = calculateTotalPassiveIncome();
                money += passiveIncome;
                updateMoneyDisplay();
                saveGame();
            }, 1000);

            if (admEventCheckInterval) clearInterval(admEventCheckInterval);
            admEventCheckInterval = setInterval(checkAdmEventChance, 60000);

            if (merchantCheckInterval) clearInterval(merchantCheckInterval);
            merchantCheckInterval = setInterval(updateMerchantTimer, 1000);

            startSessionTimer();
            
            showNotification(`Bem-vindo, ${username}! üéâ`);
        }

        function logout() {
            saveGame();
            
            if (passiveIncomeInterval) clearInterval(passiveIncomeInterval);
            if (admEventCheckInterval) clearInterval(admEventCheckInterval);
            if (merchantCheckInterval) clearInterval(merchantCheckInterval);
            if (eventInterval) clearInterval(eventInterval);
            if (admMessageInterval) clearInterval(admMessageInterval);
            stopSessionTimer();

            loggedInUser = null;
            loginPanel.style.display = 'flex';
            gamePanel.style.display = 'none';
            
            money = 0;
            inventory = {};
            firstSpin = true;
            rebirthCount = 0;
            inventoryCapacity = 10;
            obtainedFruits = [];
            spinCount = 0;
            activeEvent = null;
            currentSpinCost = BASE_SPIN_COST;
            merchantCountdown = 60;
            obtainedPets = [];
            equippedPet = null;
            sessionElapsedTime = 0;
            
            updateUI();
            resetEvent();
            logoutBtn.style.display = 'none';
            
            showNotification('Sess√£o encerrada. At√© a pr√≥xima! üëã');
        }

        loginBtn.addEventListener('click', () => {
            const username = usernameInput.value.trim();
            const password = passwordInput.value;
            
            if (!username || !password) {
                showNotification('Nome de usu√°rio e senha s√£o obrigat√≥rios.');
                return;
            }
            
            const storedPassword = localStorage.getItem(`userPassword_${username}`);

            if (storedPassword) {
                if (storedPassword === password) {
                    startGameSession(username);
                } else {
                    showNotification('Senha incorreta! ‚ùå');
                }
            } else {
                localStorage.setItem(`userData_${username}`, JSON.stringify({
                    money: 0,
                    inventory: {},
                    firstSpin: true,
                    rebirthCount: 0,
                    inventoryCapacity: 10,
                    obtainedFruits: [],
                    spinCount: 0,
                    obtainedPets: [],
                    equippedPet: null,
                    sessionElapsedTime: 0
                }));
                localStorage.setItem(`userPassword_${username}`, password);
                startGameSession(username);
            }
        });
        
        logoutBtn.addEventListener('click', logout);

        function getRandomFruit() {
            let totalChance = currentFruitList.reduce((sum, fruit) => sum + fruit.chance, 0);
            let randomNumber = Math.random() * totalChance;
            
            for (let fruit of currentFruitList) {
                if (randomNumber < fruit.chance) {
                    return fruit;
                }
                randomNumber -= fruit.chance;
            }
            return currentFruitList[0];
        }

        function updateMoneyDisplay() {
            moneyDisplay.textContent = formatMoney(money);
        }

        function updateInventoryInfo() {
            const currentFruitsCount = Object.values(inventory).reduce((sum, fruit) => sum + fruit.count, 0);
            inventoryCapacityDisplay.textContent = `${currentFruitsCount}/${inventoryCapacity} üì¶`;
            spinBtn.disabled = currentFruitsCount >= inventoryCapacity;
        }
        
        function calculateTotalPassiveIncome() {
            let passiveIncome = 0;
            for (const fruitName in inventory) {
                const fruit = inventory[fruitName];
                passiveIncome += (fruit.value * 0.005) * fruit.count;
            }
            return passiveIncome;
        }

        function addToInventory(fruit) {
            if (!inventory[fruit.name]) {
                inventory[fruit.name] = { ...fruit, count: 0 };
            }
            inventory[fruit.name].count++;
            
            if (!obtainedFruits.includes(fruit.name)) {
                obtainedFruits.push(fruit.name);
            }
        }

        function sellFruit(fruitName) {
            const fruit = inventory[fruitName];
            if (fruit && fruit.count > 0) {
                money += fruit.value;
                fruit.count--;
                updateMoneyDisplay();
                showNotification(`Voc√™ vendeu 1x ${fruit.name} por $${formatMoney(fruit.value)}! üí∞`);
                if (fruit.count === 0) {
                    delete inventory[fruitName];
                }
                renderInventory();
                updateInventoryInfo();
                saveGame();
            }
        }

        function resetEvent() {
            activeEvent = null;
            clearInterval(eventInterval);
            clearInterval(admMessageInterval);
            eventOverlay.className = 'event-overlay';
            currentSpinCost = BASE_SPIN_COST;
            updateUI();
            
            currentFruitList = [...fruits];
            admMessageContainer.style.display = 'none';
            eventTimerDisplay.classList.remove('countdown');
            updateUI();
        }
        
        function startEvent(eventName) {
            if (activeEvent) return;
            
            activeEvent = eventName;
            eventTimerDisplay.classList.add('countdown');
            
            if (eventName === 'discount') {
                eventCountdown = 60;
                currentSpinCost = Math.round(BASE_SPIN_COST * 0.30);
                showNotification("üéâ Evento de Desconto! Giros 70% mais baratos por 60s!");
                updateUI();
                eventInterval = setInterval(() => {
                    eventCountdown--;
                    eventTimerDisplay.textContent = `Evento de Desconto: ${eventCountdown}s`;
                    if (eventCountdown <= 0) resetEvent();
                }, 1000);
            } else if (eventName === 'adm') {
                eventCountdown = 120;
                eventOverlay.classList.add('adm-event');
                admMessageContainer.style.display = 'block';
                showNotification("üëë O Evento do ADM come√ßou! O que ser√° que ele est√° tramando? üëÄ");

                let messageIndex = 0;
                admMessageInterval = setInterval(() => {
                    if (messageIndex < admMessages.length) {
                        admMessageDisplay.textContent = admMessages[messageIndex];
                        messageIndex++;
                    } else {
                        messageIndex = 0;
                    }
                }, 10000);
                
                eventInterval = setInterval(() => {
                    eventCountdown--;
                    eventTimerDisplay.textContent = `Evento do ADM: ${eventCountdown}s`;
                    if (eventCountdown <= 10 && eventCountdown > 0) {
                        admMessageDisplay.textContent = "Surpresa no invent√°rio em breve! üéÅ";
                    }
                    if (eventCountdown <= 0) {
                        clearInterval(admMessageInterval);
                        admMessageDisplay.textContent = "O ADM se foi... At√© a pr√≥xima! üëã";
                        
                        const rareFruits = fruits.filter(f => f.rarity === 'Rara');
                        const randomRareFruit = rareFruits[Math.floor(Math.random() * rareFruits.length)];
                        addToInventory(randomRareFruit);
                        updateInventoryInfo();
                        showNotification(`O ADM te deu uma ${randomRareFruit.name}! üéâ`, 8000);
                        
                        setTimeout(() => {
                           resetEvent();
                        }, 5000);
                    }
                }, 1000);
            }
        }

        function checkAdmEventChance() {
            if (activeEvent) return;
            const eventChance = Math.random() * 100;
            
            if (eventChance < 1.5) {
                startEvent('adm');
            }
        }

        function updateMerchantTimer() {
            if (merchantCountdown <= 0) {
                showMerchantModal();
                merchantCountdown = 60;
            } else {
                merchantCountdown--;
            }
            merchantTimerDisplay.textContent = `Comerciante em: ${merchantCountdown}s`;
        }
        
        function showMerchantModal() {
            merchantList.innerHTML = '';
            const allFruitsWithoutAdm = fruits.filter(f => f.rarity !== 'ADM');
            const fruitsForSale = [];

            while(fruitsForSale.length < 5) {
                const randomFruit = allFruitsWithoutAdm[Math.floor(Math.random() * allFruitsWithoutAdm.length)];
                if (!fruitsForSale.some(f => f.name === randomFruit.name)) {
                    fruitsForSale.push(randomFruit);
                }
            }

            fruitsForSale.forEach(fruit => {
                const itemDiv = document.createElement('div');
                itemDiv.classList.add('item');
                itemDiv.classList.add(`rarity-${fruit.rarity.replace(' ', '')}`);
                
                itemDiv.innerHTML = `
                    <span>${fruit.emoji}</span>
                    <p>${fruit.name}</p>
                    <small>Raridade: ${fruit.rarity}</small>
                    <button data-cost="${fruit.value}" data-fruit-name="${fruit.name}">Comprar por $${formatMoney(fruit.value)}</button>
                `;
                merchantList.appendChild(itemDiv);
            });
            
            merchantModal.style.display = 'flex';
        }

        function spin() {
            const currentFruitsCount = Object.values(inventory).reduce((sum, fruit) => sum + fruit.count, 0);
            if (currentFruitsCount >= inventoryCapacity) {
                showNotification("Invent√°rio cheio! Venda algumas frutas. üóëÔ∏è");
                return;
            }
            
            const cost = firstSpin ? 0 : currentSpinCost;
            if (money < cost) {
                showNotification(`Dinheiro Insuficiente! üò≠ Requer $${formatMoney(cost)}`);
                return;
            }

            spinBtn.disabled = true;
            if (!firstSpin) {
                money -= cost;
                updateMoneyDisplay();
            }

            spinCount++;
            if (spinCount % SPINS_FOR_DISCOUNT === 0 && !activeEvent) {
                startEvent('discount');
            }
            
            const spinsLeft = SPINS_FOR_DISCOUNT - (spinCount % SPINS_FOR_DISCOUNT);
            if (!activeEvent) {
                eventTimerDisplay.textContent = `Desconto em ${spinsLeft} giros!`;
            }

            if (equippedPet) {
                money += equippedPet.bonus;
                updateMoneyDisplay();
            }

            fruitNameDisplay.textContent = "";
            fruitRarityDisplay.textContent = "";
            slot.className = 'slot';
            
            let count = 0;
            const result = getRandomFruit();
            
            const interval = setInterval(() => {
                slot.textContent = fruits[Math.floor(Math.random() * fruits.length)].emoji;
                count++;
                
                if (count > 30) {
                    clearInterval(interval);
                    slot.textContent = result.emoji;
                    slot.classList.add(`rarity-${result.rarity.replace(' ', '')}`);
                    fruitNameDisplay.textContent = result.name;
                    fruitRarityDisplay.textContent = result.rarity;

                    money += result.value;
                    addToInventory(result);
                    updateMoneyDisplay();
                    updateInventoryInfo();
                    spinBtn.disabled = false;
                    
                    if (firstSpin) {
                        firstSpin = false;
                        spinCostDisplay.textContent = `Custo: $${formatMoney(currentSpinCost)}`;
                    }
                    saveGame();
                }
            }, 50);
        }

        function performRebirth(rebirthLevel) {
            const req = rebirths[rebirthLevel - 1];
            const fruitCount = inventory[req.fruit] ? inventory[req.fruit].count : 0;

            if (money >= req.cost && fruitCount >= 1) {
                money = (rebirthLevel) * 350;
                inventory = {};
                rebirthCount++;
                inventoryCapacity += 10;
                firstSpin = true;
                
                updateMoneyDisplay();
                rebirthCountDisplay.textContent = rebirthCount;
                spinCostDisplay.textContent = `1¬∫ Giro Gr√°tis!`;
                
                showNotification(`Rebirth ${rebirthLevel} realizado com sucesso! üéâ Nova capacidade: ${inventoryCapacity}`);
                
                renderRebirthPanel();
                updateInventoryInfo();
                inventoryModal.style.display = 'none';
                rebirthModal.style.display = 'none';
                saveGame();
            } else {
                let message = "Voc√™ n√£o cumpre os requisitos! üö´ ";
                if (money < req.cost) {
                    message += `Requer $${formatMoney(req.cost)}. `;
                }
                if (fruitCount < 1) {
                    message += `Requer 1x ${req.fruit}.`;
                }
                showNotification(message);
            }
        }

        function renderRebirthPanel() {
            rebirthList.innerHTML = '';
            const currentRebirthIndex = rebirthCount;
            
            for (let i = 0; i < rebirths.length; i++) {
                const req = rebirths[i];
                const rebirthLevel = i + 1;
                
                const panel = document.createElement('div');
                panel.classList.add('rebirth-stage');
                
                const fruitCount = inventory[req.fruit] ? inventory[req.fruit].count : 0;
                const canRebirth = money >= req.cost && fruitCount >= 1;
                
                let status = '';
                let btnText = '';
                let btnDisabled = true;
                
                if (i < currentRebirthIndex) {
                    status = 'Completo ‚úÖ';
                    btnText = 'Completado';
                    btnDisabled = true;
                    panel.style.opacity = '0.7';
                } else if (i === currentRebirthIndex) {
                    status = 'Pr√≥ximo Rebirth ‚û°Ô∏è';
                    btnText = 'Fazer Rebirth';
                    btnDisabled = !canRebirth;
                    panel.classList.add('unlocked');
                } else {
                    status = 'Bloqueado üîí';
                    btnText = 'Bloqueado';
                    btnDisabled = true;
                    panel.style.opacity = '0.5';
                }

                panel.innerHTML = `
                    <h4>Rebirth ${rebirthLevel}</h4>
                    <p>Status: ${status}</p>
                    <p>Requisitos:</p>
                    <ul>
                        <li>Dinheiro: ${money >= req.cost ? '‚úÖ' : '‚ùå'} $${formatMoney(req.cost)}</li>
                        <li>Fruta: ${fruitCount >= 1 ? '‚úÖ' : '‚ùå'} 1x ${req.fruit} ${req.emoji}</li>
                    </ul>
                    <button id="rebirth-btn-${rebirthLevel}" ${btnDisabled ? 'disabled' : ''}>${btnText}</button>
                `;
                
                rebirthList.appendChild(panel);
                
                if (i === currentRebirthIndex) {
                    document.getElementById(`rebirth-btn-${rebirthLevel}`).addEventListener('click', () => {
                        performRebirth(rebirthLevel);
                    });
                }
            }
        }

        function renderInventory() {
            inventoryList.innerHTML = '';
            const sortedFruits = Object.values(inventory).sort((a, b) => {
                return rarities.indexOf(a.rarity) - rarities.indexOf(b.rarity);
            });
            
            const totalPassiveIncome = calculateTotalPassiveIncome();
            inventoryTotalIncomeDisplay.textContent = `Renda Passiva Total: $${totalPassiveIncome.toFixed(2)}/s`;

            for (const fruit of sortedFruits) {
                const itemDiv = document.createElement('div');
                itemDiv.classList.add('item', 'inventory-item');
                itemDiv.dataset.fruitName = fruit.name;
                itemDiv.classList.add(`rarity-${fruit.rarity.replace(' ', '')}`);
                
                const incomePerSecond = (fruit.value * 0.005).toFixed(2);
                
                itemDiv.innerHTML = `
                    <span>${fruit.emoji}</span>
                    <p>${fruit.name}</p>
                    <small>Raridade: ${fruit.rarity}</small>
                    <small>Qtd: x${fruit.count}</small>
                    <small>Valor: $${formatMoney(fruit.value)}</small>
                    <small>Renda/s: +$${incomePerSecond}</small>
                `;
                inventoryList.appendChild(itemDiv);
            }
            if (Object.keys(inventory).length === 0) {
                inventoryTotalIncomeDisplay.textContent = 'Renda Passiva Total: $0.00/s';
                inventoryList.innerHTML = '<p style="grid-column: 1 / -1; text-align: center;">Seu invent√°rio est√° vazio. Gire para come√ßar! üçé</p>';
            }
        }
        
        function renderCatalog() {
            catalogList.innerHTML = '';
            
            for (const rarity of rarities) {
                const section = document.createElement('div');
                section.classList.add('catalog-section');
                
                const sectionTitle = document.createElement('h3');
                sectionTitle.textContent = rarity;
                sectionTitle.classList.add(`rarity-${rarity.replace(' ', '')}`);
                section.appendChild(sectionTitle);
                
                const grid = document.createElement('div');
                grid.classList.add('item-grid');
                
                const fruitsInRarity = fruitsByRarity[rarity] || [];
                
                for (const fruit of fruitsInRarity) {
                    const itemDiv = document.createElement('div');
                    itemDiv.classList.add('item');
                    itemDiv.classList.add(`rarity-${fruit.rarity.replace(' ', '')}`);
                    
                    const isObtained = obtainedFruits.includes(fruit.name);
                    if (!isObtained) {
                        itemDiv.classList.add('unobtained');
                    }
                    
                    const value = isObtained ? `$${formatMoney(fruit.value)}` : "???";
                    
                    itemDiv.innerHTML = `
                        <span>${fruit.emoji}</span>
                        <p>${fruit.name}</p>
                        <small>Valor: ${value}</small>
                    `;
                    grid.appendChild(itemDiv);
                }
                
                section.appendChild(grid);
                catalogList.appendChild(section);
            }
        }
        
        function renderPetShop() {
            petshopList.innerHTML = '';
            for(const pet of pets) {
                const itemDiv = document.createElement('div');
                itemDiv.classList.add('item');
                
                const hasPet = obtainedPets.includes(pet.name);
                const isEquipped = equippedPet && equippedPet.name === pet.name;
                
                if (isEquipped) {
                    itemDiv.classList.add('equiped');
                }

                itemDiv.innerHTML = `
                    <span>${pet.emoji}</span>
                    <p>${pet.name}</p>
                    <small>B√¥nus por giro: +$${formatMoney(pet.bonus)}</small>
                    ${hasPet ? `<button data-pet-name="${pet.name}" class="equip-btn">${isEquipped ? 'Equipado' : 'Equipar'}</button>` : `<button data-pet-name="${pet.name}" class="buy-btn">Comprar por $${formatMoney(pet.cost)}</button>`}
                `;

                petshopList.appendChild(itemDiv);
            }
        }
        
        function handlePetShopClick(event) {
            const btn = event.target.closest('button');
            if (!btn) return;
            
            const petName = btn.dataset.petName;
            const pet = pets.find(p => p.name === petName);

            if (btn.classList.contains('buy-btn')) {
                if (money >= pet.cost) {
                    money -= pet.cost;
                    obtainedPets.push(pet.name);
                    equippedPet = pet;
                    updateMoneyDisplay();
                    showNotification(`Voc√™ comprou e equipou o ${pet.name}! üéâ`);
                    renderPetShop();
                    saveGame();
                } else {
                    showNotification(`Dinheiro Insuficiente! Requer $${formatMoney(pet.cost)}.`);
                }
            } else if (btn.classList.contains('equip-btn')) {
                equippedPet = pet;
                showNotification(`Voc√™ equipou o ${pet.name}! üêæ`);
                renderPetShop();
                saveGame();
            }
        }
        
        function renderAdminPanel() {
            adminFruitList.innerHTML = '';
            const allFruits = [...fruits].sort((a,b) => rarities.indexOf(a.rarity) - rarities.indexOf(b.rarity));

            for(const fruit of allFruits) {
                const itemDiv = document.createElement('div');
                itemDiv.classList.add('item');
                itemDiv.dataset.fruitName = fruit.name;
                itemDiv.classList.add(`rarity-${fruit.rarity.replace(' ', '')}`);
                
                itemDiv.innerHTML = `
                    <span>${fruit.emoji}</span>
                    <p>${fruit.name}</p>
                    <small>${fruit.rarity}</small>
                `;

                itemDiv.addEventListener('click', () => {
                    const fruitToAdd = fruits.find(f => f.name === fruit.name);
                    if (fruitToAdd) {
                        addToInventory(fruitToAdd);
                        updateInventoryInfo();
                        showNotification(`Voc√™ spawnou uma ${fruit.name}! üéÅ`);
                        saveGame();
                    }
                });
                adminFruitList.appendChild(itemDiv);
            }
        }

        spinBtn.addEventListener('click', spin);
        inventoryBtn.addEventListener('click', () => {
            renderInventory();
            inventoryModal.style.display = 'flex';
        });
        catalogBtn.addEventListener('click', () => {
            renderCatalog();
            catalogModal.style.display = 'flex';
        });
        rebirthBtn.addEventListener('click', () => {
            renderRebirthPanel();
            rebirthModal.style.display = 'flex';
        });
        adminBtn.addEventListener('click', () => {
            renderAdminPanel();
            adminPanel.style.display = 'flex';
        });
        petshopBtn.addEventListener('click', () => {
            renderPetShop();
            petshopModal.style.display = 'flex';
        });
        petshopList.addEventListener('click', handlePetShopClick);

        admEventMoneyBtn.addEventListener('click', () => {
             const amount = Math.floor(Math.random() * 4669) + 10;
             money += amount;
             updateMoneyDisplay();
             showNotification(`üí∏ O ADM te deu $${formatMoney(amount)}!`);
        });
        admEventDiscountBtn.addEventListener('click', () => startEvent('discount'));
        admEventAdmBtn.addEventListener('click', () => startEvent('adm'));

        closeBtns.forEach(btn => {
            btn.addEventListener('click', (event) => {
                const modal = event.target.closest('.modal');
                if (modal) {
                    modal.style.display = 'none';
                    if (modal.id === 'merchant-modal') {
                        merchantCountdown = 60;
                        merchantTimerDisplay.textContent = `Comerciante em: ${merchantCountdown}s`;
                    }
                }
            });
        });
        
        window.addEventListener('click', (event) => {
            if (event.target === inventoryModal) inventoryModal.style.display = 'none';
            if (event.target === catalogModal) catalogModal.style.display = 'none';
            if (event.target === rebirthModal) rebirthModal.style.display = 'none';
            if (event.target === adminPanel) adminPanel.style.display = 'none';
            if (event.target === petshopModal) petshopModal.style.display = 'none';
            if (event.target === merchantModal) {
                 merchantModal.style.display = 'none';
                 merchantCountdown = 60;
                 merchantTimerDisplay.textContent = `Comerciante em: ${merchantCountdown}s`;
            }
        });
        
        inventoryList.addEventListener('click', (event) => {
            const item = event.target.closest('.inventory-item');
            if (item) {
                const fruitName = item.dataset.fruitName;
                sellFruit(fruitName);
            }
        });

        merchantList.addEventListener('click', (event) => {
            const btn = event.target.closest('button');
            if (btn) {
                const cost = parseFloat(btn.dataset.cost);
                const fruitName = btn.dataset.fruitName;

                if (Object.values(inventory).reduce((sum, f) => sum + f.count, 0) >= inventoryCapacity) {
                    showNotification("Invent√°rio cheio! N√£o √© poss√≠vel comprar mais frutas.");
                    return;
                }

                if (money >= cost) {
                    money -= cost;
                    const fruitToBuy = fruits.find(f => f.name === fruitName);
                    addToInventory(fruitToBuy);
                    updateMoneyDisplay();
                    updateInventoryInfo();
                    showNotification(`Voc√™ comprou uma ${fruitName} por $${formatMoney(cost)}!`);
                    saveGame();
                    merchantModal.style.display = 'none';
                    merchantCountdown = 60;
                    merchantTimerDisplay.textContent = `Comerciante em: ${merchantCountdown}s`;
                } else {
                    showNotification("Dinheiro insuficiente para comprar esta fruta.");
                }
            }
        });

        // Inicializa o jogo mostrando o painel de login
        loginPanel.style.display = 'flex';
    </script>
</body>
</html>